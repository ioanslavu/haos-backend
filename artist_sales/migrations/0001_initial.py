# Generated by Django 5.2.7 on 2025-11-06 18:27

import django.contrib.postgres.fields
import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('api', '0016_alter_departmentrequest_requested_department'),
        ('identity', '0019_remove_entity_entity_name_trgm_idx_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='DeliverablePack',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="Pack name (e.g., 'Standard IG Package', 'TVC + Digital Bundle')", max_length=255, unique=True)),
                ('description', models.TextField(blank=True, help_text="Description of what's included")),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Whether this pack is active/available')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Deliverable Pack',
                'verbose_name_plural': 'Deliverable Packs',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='UsageTerms',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="Name of the usage terms (e.g., 'Digital Only - 12mo', 'Global ATL + BTL - 24mo')", max_length=255)),
                ('usage_scope', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(choices=[('digital', 'Digital'), ('atl', 'ATL (Above The Line)'), ('btl', 'BTL (Below The Line)'), ('ooh', 'OOH (Out of Home)'), ('packaging', 'Product Packaging'), ('in_store', 'In-Store'), ('global', 'Global Rights'), ('print', 'Print Media'), ('broadcast', 'Broadcast (TV/Radio)'), ('cinema', 'Cinema'), ('events', 'Events')], max_length=50), blank=True, default=list, help_text='Types of usage rights granted', size=None)),
                ('territories', models.JSONField(blank=True, default=list, help_text='List of ISO country codes for territories')),
                ('exclusivity_category', models.CharField(blank=True, help_text="Product category for exclusivity (e.g., 'Beverage', 'Automotive')", max_length=100)),
                ('exclusivity_duration_days', models.IntegerField(blank=True, help_text='Exclusivity duration in days', null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('usage_duration_days', models.IntegerField(default=365, help_text='Usage rights duration in days', validators=[django.core.validators.MinValueValidator(1)])),
                ('extensions_allowed', models.BooleanField(default=False, help_text='Whether usage can be extended')),
                ('buyout', models.BooleanField(default=False, help_text='Whether this is a full buyout (perpetual rights)')),
                ('brand_list_blocked', models.JSONField(blank=True, default=list, help_text='List of competing brands blocked during exclusivity')),
                ('is_template', models.BooleanField(db_index=True, default=True, help_text='Whether this is a reusable template')),
                ('notes', models.TextField(blank=True, help_text='Additional notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Usage Terms',
                'verbose_name_plural': 'Usage Terms',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='DeliverablePackItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('deliverable_type', models.CharField(choices=[('ig_post', 'Instagram Post'), ('ig_story', 'Instagram Story'), ('ig_reel', 'Instagram Reel'), ('tiktok_video', 'TikTok Video'), ('youtube_video', 'YouTube Video'), ('youtube_short', 'YouTube Short'), ('tvc', 'TV Commercial'), ('radio_spot', 'Radio Spot'), ('event', 'Event Appearance'), ('ooh', 'Out of Home (OOH)'), ('billboard', 'Billboard'), ('packaging', 'Product Packaging'), ('print_ad', 'Print Advertisement'), ('digital_banner', 'Digital Banner'), ('podcast', 'Podcast'), ('livestream', 'Livestream'), ('other', 'Other')], help_text='Type of deliverable', max_length=50)),
                ('quantity', models.IntegerField(default=1, help_text='Quantity of this deliverable type', validators=[django.core.validators.MinValueValidator(1)])),
                ('description', models.TextField(blank=True, help_text='Additional description')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('pack', models.ForeignKey(help_text='Deliverable pack', on_delete=django.db.models.deletion.CASCADE, related_name='items', to='artist_sales.deliverablepack')),
            ],
            options={
                'verbose_name': 'Deliverable Pack Item',
                'verbose_name_plural': 'Deliverable Pack Items',
                'ordering': ['deliverable_type', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='Opportunity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('opportunity_number', models.CharField(blank=True, db_index=True, help_text='Auto-generated: OPP-2025-00001', max_length=50, unique=True)),
                ('title', models.CharField(db_index=True, help_text="e.g., 'Nike x Drake - Summer Campaign'", max_length=255)),
                ('stage', models.CharField(choices=[('brief', 'üì• Brief Intake'), ('qualified', '‚úÖ Qualified'), ('shortlist', 'üé§ Artist Shortlist'), ('proposal_draft', 'üìÑ Proposal Draft'), ('proposal_sent', 'üìß Proposal Sent'), ('negotiation', 'üí¨ Negotiation'), ('contract_prep', 'üìù Contract Prep'), ('contract_sent', '‚úçÔ∏è Contract Sent'), ('won', 'üéØ Won'), ('executing', 'üöÄ Executing'), ('completed', '‚ú® Completed'), ('closed_lost', '‚ùå Lost')], db_index=True, default='brief', help_text='Current pipeline stage', max_length=20)),
                ('probability', models.IntegerField(default=10, help_text='Probability of closing (%)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('priority', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('urgent', 'Urgent')], db_index=True, default='medium', help_text='Opportunity priority', max_length=20)),
                ('estimated_value', models.DecimalField(blank=True, decimal_places=2, help_text='Estimated deal value', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('currency', models.CharField(default='EUR', help_text='Currency code', max_length=3)),
                ('expected_close_date', models.DateField(blank=True, db_index=True, help_text='Expected closing date', null=True)),
                ('actual_close_date', models.DateField(blank=True, help_text='Actual close date (won or lost)', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('campaign_objectives', models.TextField(blank=True, help_text='Campaign goals and objectives')),
                ('target_audience', models.TextField(blank=True, help_text='Target audience description')),
                ('channels', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=50), blank=True, default=list, help_text='Marketing channels (social, tvc, ooh, print, etc.)', size=None)),
                ('brand_category', models.CharField(blank=True, help_text='Brand/product category (e.g., Beverage, Fashion, Tech)', max_length=100)),
                ('budget_range_min', models.DecimalField(blank=True, decimal_places=2, help_text='Minimum budget range', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('budget_range_max', models.DecimalField(blank=True, decimal_places=2, help_text='Maximum budget range', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('campaign_start_date', models.DateField(blank=True, help_text='Desired campaign start date', null=True)),
                ('campaign_end_date', models.DateField(blank=True, help_text='Desired campaign end date', null=True)),
                ('proposal_version', models.IntegerField(default=0, help_text='Current proposal version number')),
                ('proposal_history', models.JSONField(blank=True, default=list, help_text='Proposal version history with timestamps')),
                ('fee_gross', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Gross fee before discounts', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('agency_fee', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Agency commission/fee', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('discounts', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total discounts', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('fee_net', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Net fee (calculated: gross - discounts - agency_fee)', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('proposal_sent_date', models.DateTimeField(blank=True, help_text='When proposal was sent to client', null=True)),
                ('proposal_valid_until', models.DateField(blank=True, help_text='Proposal validity date', null=True)),
                ('contract_number', models.CharField(blank=True, db_index=True, help_text='Auto-generated when won: AS-2025-00001', max_length=50, null=True, unique=True)),
                ('po_number', models.CharField(blank=True, help_text='Client purchase order number', max_length=100)),
                ('contract_signed_date', models.DateField(blank=True, help_text='Date contract was signed', null=True)),
                ('contract_start_date', models.DateField(blank=True, help_text='Contract start date', null=True)),
                ('contract_end_date', models.DateField(blank=True, help_text='Contract end date', null=True)),
                ('contract_file', models.FileField(blank=True, help_text='Signed contract document', null=True, upload_to='opportunities/contracts/')),
                ('lost_reason', models.TextField(blank=True, help_text='Reason if opportunity was lost')),
                ('lost_date', models.DateField(blank=True, help_text='Date marked as lost', null=True)),
                ('competitor', models.CharField(blank=True, help_text='Competitor who won (if known)', max_length=255)),
                ('notes', models.TextField(blank=True, help_text='Internal notes')),
                ('tags', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=50), blank=True, default=list, help_text='Tags for categorization', size=None)),
                ('account', models.ForeignKey(help_text='Brand or agency', on_delete=django.db.models.deletion.PROTECT, related_name='opportunities', to='identity.entity')),
                ('contact_person', models.ForeignKey(blank=True, help_text='Primary contact at account', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='identity.contactperson')),
                ('created_by', models.ForeignKey(help_text='User who created this opportunity', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_opportunities', to=settings.AUTH_USER_MODEL)),
                ('deliverable_pack', models.ForeignKey(blank=True, help_text='Deliverable pack template (optional)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='artist_sales.deliverablepack')),
                ('owner', models.ForeignKey(help_text='Sales owner responsible for this opportunity', on_delete=django.db.models.deletion.PROTECT, related_name='owned_opportunities', to=settings.AUTH_USER_MODEL)),
                ('team', models.ForeignKey(blank=True, help_text='Department/team (e.g., Digital, Artist Sales)', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='opportunities', to='api.department')),
                ('usage_terms', models.ForeignKey(blank=True, help_text='Image rights and usage terms (optional)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='opportunities', to='artist_sales.usageterms')),
            ],
            options={
                'verbose_name': 'Opportunity',
                'verbose_name_plural': 'Opportunities',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='OpportunityDeliverable',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('deliverable_type', models.CharField(choices=[('ig_post', 'Instagram Post'), ('ig_story', 'Instagram Story'), ('ig_reel', 'Instagram Reel'), ('tiktok_video', 'TikTok Video'), ('youtube_video', 'YouTube Video'), ('youtube_short', 'YouTube Short'), ('tvc', 'TV Commercial'), ('radio_spot', 'Radio Spot'), ('event', 'Event Appearance'), ('ooh', 'Out of Home (OOH)'), ('billboard', 'Billboard'), ('packaging', 'Product Packaging'), ('print_ad', 'Print Advertisement'), ('digital_banner', 'Digital Banner'), ('podcast', 'Podcast'), ('livestream', 'Livestream'), ('other', 'Other')], help_text='Type of deliverable', max_length=50)),
                ('quantity', models.IntegerField(default=1, help_text='Quantity', validators=[django.core.validators.MinValueValidator(1)])),
                ('description', models.TextField(blank=True, help_text='Description')),
                ('due_date', models.DateField(blank=True, help_text='Due date', null=True)),
                ('status', models.CharField(choices=[('planned', 'Planned'), ('in_progress', 'In Progress'), ('submitted', 'Submitted for Approval'), ('approved', 'Approved'), ('revision_requested', 'Revision Requested'), ('completed', 'Completed')], db_index=True, default='planned', help_text='Current status', max_length=20)),
                ('asset_url', models.URLField(blank=True, help_text='URL to asset (S3, Google Drive, etc.)', max_length=500)),
                ('kpi_target', models.JSONField(blank=True, default=dict, help_text='Target KPIs (e.g., {views: 1000000, engagement_rate: 0.05})')),
                ('kpi_actual', models.JSONField(blank=True, default=dict, help_text='Actual KPIs achieved')),
                ('cost_center', models.CharField(blank=True, help_text='Internal cost center code', max_length=100)),
                ('notes', models.TextField(blank=True, help_text='Additional notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='deliverables', to='artist_sales.opportunity')),
            ],
            options={
                'verbose_name': 'Opportunity Deliverable',
                'verbose_name_plural': 'Opportunity Deliverables',
                'ordering': ['due_date', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='Approval',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('stage', models.CharField(choices=[('concept', 'Concept'), ('script', 'Script'), ('storyboard', 'Storyboard'), ('rough_cut', 'Rough Cut'), ('final_cut', 'Final Cut'), ('caption', 'Caption/Copy'), ('static_kv', 'Static Key Visual'), ('usage_extension', 'Usage Extension Request'), ('other', 'Other')], help_text='Approval stage', max_length=20)),
                ('version', models.IntegerField(default=1, help_text='Version number for this stage')),
                ('status', models.CharField(choices=[('pending', 'Pending Review'), ('approved', 'Approved'), ('changes_requested', 'Changes Requested'), ('rejected', 'Rejected')], db_index=True, default='pending', help_text='Approval status', max_length=20)),
                ('submitted_at', models.DateTimeField(auto_now_add=True, help_text='When submitted for approval')),
                ('approved_at', models.DateTimeField(blank=True, help_text='When approved/rejected', null=True)),
                ('notes', models.TextField(blank=True, help_text='Approval notes/feedback')),
                ('file_url', models.FileField(blank=True, help_text='File to be approved', null=True, upload_to='approvals/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approver_contact', models.ForeignKey(blank=True, help_text='Client-side approver', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approvals_given', to='identity.contactperson')),
                ('approver_user', models.ForeignKey(blank=True, help_text='Internal approver', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approvals_given', to=settings.AUTH_USER_MODEL)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to='artist_sales.opportunity')),
                ('deliverable', models.ForeignKey(blank=True, help_text='Specific deliverable (optional)', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to='artist_sales.opportunitydeliverable')),
            ],
            options={
                'verbose_name': 'Approval',
                'verbose_name_plural': 'Approvals',
                'ordering': ['-submitted_at'],
            },
        ),
        migrations.CreateModel(
            name='OpportunityTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(help_text='Task title', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Task description')),
                ('task_type', models.CharField(choices=[('artist_outreach', 'Artist Outreach'), ('proposal_creation', 'Proposal Creation'), ('contract_prep', 'Contract Preparation'), ('client_meeting', 'Client Meeting'), ('deliverable_review', 'Deliverable Review'), ('follow_up', 'Follow Up'), ('other', 'Other')], default='other', help_text='Type of task', max_length=50)),
                ('due_date', models.DateField(blank=True, help_text='Task due date', null=True)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('urgent', 'Urgent')], default='medium', help_text='Task priority', max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], db_index=True, default='pending', help_text='Task status', max_length=20)),
                ('completed_at', models.DateTimeField(blank=True, help_text='When task was completed', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_by', models.ForeignKey(help_text='User who created/assigned this task', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_opportunity_tasks', to=settings.AUTH_USER_MODEL)),
                ('assigned_to', models.ForeignKey(help_text='User assigned to this task', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_opportunity_tasks', to=settings.AUTH_USER_MODEL)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='artist_sales.opportunity')),
            ],
            options={
                'verbose_name': 'Opportunity Task',
                'verbose_name_plural': 'Opportunity Tasks',
                'ordering': ['due_date', '-priority', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='Invoice',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('invoice_number', models.CharField(blank=True, db_index=True, help_text='Auto-generated invoice number', max_length=50, unique=True)),
                ('invoice_type', models.CharField(choices=[('advance', 'Advance Payment'), ('milestone', 'Milestone Payment'), ('final', 'Final Payment'), ('full', 'Full Payment')], default='full', help_text='Invoice type', max_length=20)),
                ('issue_date', models.DateField(help_text='Invoice issue date')),
                ('due_date', models.DateField(help_text='Payment due date')),
                ('amount', models.DecimalField(decimal_places=2, help_text='Invoice amount', max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('currency', models.CharField(default='EUR', help_text='Currency', max_length=3)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('issued', 'Issued'), ('sent', 'Sent to Client'), ('paid', 'Paid'), ('overdue', 'Overdue'), ('cancelled', 'Cancelled')], db_index=True, default='draft', help_text='Invoice status', max_length=20)),
                ('paid_date', models.DateField(blank=True, help_text='Date when payment was received', null=True)),
                ('pdf_url', models.FileField(blank=True, help_text='Invoice PDF file', null=True, upload_to='invoices/')),
                ('notes', models.TextField(blank=True, help_text='Additional notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='invoices', to='artist_sales.opportunity')),
            ],
            options={
                'verbose_name': 'Invoice',
                'verbose_name_plural': 'Invoices',
                'ordering': ['-issue_date', '-created_at'],
                'indexes': [models.Index(fields=['opportunity', 'status'], name='artist_sale_opportu_0b2994_idx'), models.Index(fields=['status', 'due_date'], name='artist_sale_status_6ab7b5_idx'), models.Index(fields=['issue_date'], name='artist_sale_issue_d_90ca05_idx')],
            },
        ),
        migrations.CreateModel(
            name='OpportunityActivity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('activity_type', models.CharField(choices=[('created', 'Created'), ('stage_changed', 'Stage Changed'), ('field_updated', 'Field Updated'), ('comment_added', 'Comment Added'), ('task_created', 'Task Created'), ('task_completed', 'Task Completed'), ('artist_added', 'Artist Added'), ('artist_removed', 'Artist Removed'), ('file_uploaded', 'File Uploaded'), ('email_sent', 'Email Sent'), ('meeting_logged', 'Meeting Logged'), ('proposal_sent', 'Proposal Sent'), ('contract_sent', 'Contract Sent'), ('won', 'Marked as Won'), ('lost', 'Marked as Lost')], db_index=True, help_text='Type of activity', max_length=50)),
                ('title', models.CharField(help_text="Activity title (e.g., 'Stage changed to Proposal Sent')", max_length=255)),
                ('description', models.TextField(blank=True, help_text='Detailed description')),
                ('metadata', models.JSONField(blank=True, default=dict, help_text='Structured data about the activity')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='activities', to='artist_sales.opportunity')),
                ('user', models.ForeignKey(blank=True, help_text='User who performed the action (null for system activities)', null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Opportunity Activity',
                'verbose_name_plural': 'Opportunity Activities',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['opportunity', '-created_at'], name='artist_sale_opportu_2679b1_idx'), models.Index(fields=['activity_type', '-created_at'], name='artist_sale_activit_625be0_idx')],
            },
        ),
        migrations.CreateModel(
            name='OpportunityArtist',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(choices=[('main', 'Main Artist'), ('featured', 'Featured'), ('guest', 'Guest'), ('ensemble', 'Ensemble')], default='main', help_text='Artist role in this opportunity', max_length=20)),
                ('proposed_fee', models.DecimalField(blank=True, decimal_places=2, help_text='Proposed artist fee (in proposal stage)', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('confirmed_fee', models.DecimalField(blank=True, decimal_places=2, help_text='Confirmed artist fee (after negotiation)', max_digits=12, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('contract_status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent'), ('signed', 'Signed'), ('active', 'Active')], default='pending', help_text='Artist contract status', max_length=20)),
                ('signed_date', models.DateField(blank=True, help_text='Date artist signed contract', null=True)),
                ('notes', models.TextField(blank=True, help_text="Notes about this artist's participation")),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('artist', models.ForeignKey(help_text='Artist entity', limit_choices_to={'entity_roles__role': 'artist'}, on_delete=django.db.models.deletion.PROTECT, related_name='opportunity_participations', to='identity.entity')),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='artists', to='artist_sales.opportunity')),
            ],
            options={
                'verbose_name': 'Opportunity Artist',
                'verbose_name_plural': 'Opportunity Artists',
                'ordering': ['role', 'created_at'],
                'unique_together': {('opportunity', 'artist')},
            },
        ),
        migrations.CreateModel(
            name='OpportunityComment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('comment', models.TextField(help_text='Comment text (supports mentions with @username)')),
                ('is_internal', models.BooleanField(default=True, help_text='Internal note (vs client-visible)')),
                ('mentions', django.contrib.postgres.fields.ArrayField(base_field=models.IntegerField(), blank=True, default=list, help_text='User IDs mentioned in this comment', size=None)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('opportunity', models.ForeignKey(help_text='Opportunity', on_delete=django.db.models.deletion.CASCADE, related_name='comments', to='artist_sales.opportunity')),
                ('user', models.ForeignKey(help_text='User who created the comment', null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Opportunity Comment',
                'verbose_name_plural': 'Opportunity Comments',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['opportunity', '-created_at'], name='artist_sale_opportu_1cccdb_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='opportunitydeliverable',
            index=models.Index(fields=['opportunity', 'status'], name='artist_sale_opportu_24d9f4_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunitydeliverable',
            index=models.Index(fields=['due_date'], name='artist_sale_due_dat_fa7e93_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunitydeliverable',
            index=models.Index(fields=['status', 'due_date'], name='artist_sale_status_52706e_idx'),
        ),
        migrations.AddIndex(
            model_name='approval',
            index=models.Index(fields=['opportunity', 'status'], name='artist_sale_opportu_8db5f4_idx'),
        ),
        migrations.AddIndex(
            model_name='approval',
            index=models.Index(fields=['deliverable', 'stage'], name='artist_sale_deliver_cbc5a9_idx'),
        ),
        migrations.AddIndex(
            model_name='approval',
            index=models.Index(fields=['status', 'submitted_at'], name='artist_sale_status_fdcd23_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunitytask',
            index=models.Index(fields=['opportunity', 'status'], name='artist_sale_opportu_30e3a8_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunitytask',
            index=models.Index(fields=['assigned_to', 'status'], name='artist_sale_assigne_578fe0_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunitytask',
            index=models.Index(fields=['due_date'], name='artist_sale_due_dat_80dc24_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['stage', '-created_at'], name='artist_sale_stage_12b238_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['owner', 'stage'], name='artist_sale_owner_i_9ec4f4_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['team', 'stage'], name='artist_sale_team_id_d26cb9_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['account', 'stage'], name='artist_sale_account_aafca0_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['expected_close_date'], name='artist_sale_expecte_c1515a_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['-estimated_value'], name='artist_sale_estimat_fabc15_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['priority', 'stage'], name='artist_sale_priorit_5ecad1_idx'),
        ),
        migrations.AddIndex(
            model_name='opportunity',
            index=models.Index(fields=['created_at'], name='artist_sale_created_7f0fdc_idx'),
        ),
    ]
